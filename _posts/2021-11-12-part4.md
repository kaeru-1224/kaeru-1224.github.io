---
layout: post

title: Second Posting:ê°¯ì¸ ë¹„ì°ë¨¹!-Part 4:Gatsbyâ€™s GraphQL data layer
tags: Gatsby
date: 2021-11-12 06:42
---

<h3>Meet Gatsbyâ€™s GraphQL data layer</h3>

ì´ì „ê¹Œì§€ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì— ë°”ë¡œ ì´ë¯¸ì§€ë‚˜ ë¬¸ì¥ì„ ì ì–´ì™”ì§€ë§Œ ì¢…ì¢… ë§ˆí¬ë‹¤ìš´ íŒŒì¼ì˜ í´ë”ë‚˜ CMS (content managemebt system)ë“±ì„ í™œìš©í•´ì„œ ë°ì´í„°ë¥¼ ë§Œë“¤ê³  ìœ ì§€í•œë‹¤ìŒ í•„ìš”ì—ë”°ë¼ ì»´í¬ë„ŒíŠ¸ì— ë„£ì–´ì£¼ëŠ” ë°©ë²• ì—­ì‹œ ìš©ì´í•˜ë‹¤.

âœ…Data layer

![datalayer_ex](https://www.gatsbyjs.com/static/e45422900475b86807bc002fb6863b85/5df5d/data-layer.png)

ê°¯ì¸ ë¹„ëŠ” ì–´ë””ë¡œë¶€í„°ë‚˜ ë°ì´í„°ë¥¼ ë°ë ¤ì˜¬ ìˆ˜ ìˆëŠ” ë°ì´í„° ë ˆì´ì–´ë¥¼ ì§€ë‹ˆê³  ìˆë‹¤.
ê·¸ëŸ°ë° ì—¬ê¸°ì„œ `ì–´ë””ë¡œë¶€í„°`ëŠ” ë‹¨ì–´ ê·¸ëŒ€ë¡œ ë°ì´í„°ë¥¼ Shopifyë‚˜ Airtableì— ë„£ì–´ë„ ì—¬ëŸ¬ ë°ì´í„° ì†ŒìŠ¤ë“¤ì„ ê²°í•©í•´ì„œ ì‚¬ìš©í•  ìˆ˜ìˆë„ë¡ í•œë‹¤ëŠ” ì˜ë¯¸ë¡œ GraphQLì´ ì´ëŸ¬í•œ ì‘ì—…ì„ í• ìˆ˜ìˆë„ë¡£ ìš°ë¦¬ë¥¼ ë„ì™€ì¤„ ê²ƒì´ë‹¤.

ğŸ¤” ê·¸ëŸ¬ë©´ GraphQLì´ ì–´ë–¤ì‹ìœ¼ë¡œ ì‘ë™í• ê¹Œ?

- í•œê°œ í˜¹ì€ ê·¸ì´ìƒì˜ `ê³µê°„(source)`ì— ë°ì´í„°ê°€ ì €ì¥ëœë‹¤. ì´ë•Œ ê·¸
  ê³µê°„ì€ ì‚¬ìš©ìì˜ ì»´í“¨í„°ì˜ íŒŒì¼ ì‹œìŠ¤í…œì¼ìˆ˜ë„ ìˆê³  CMSì¼ìˆ˜ë„ ìˆìœ¼ë©° í˜¹ì€ ë°ì´í„° ë² ì´ìŠ¤ ì¼ìˆ˜ë„ ìˆë‹¤.

ğŸ¤” ê·¸ëŸ¬ë©´ ê·¸ ê³µê°„ìœ¼ë¡œë¶€í„° ë°ì´í„°ë ˆì´ì•„ì›ƒê¹Œì§€ ë°ì´í„°ëŠ” ì–´ë–»ê²Œ ì–»ì„ ìˆ˜ìˆì„ê¹Œ.

- ê°¯ì¸ ë¹„ì˜ ê²½ìš° `source plugin`ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë°ì´í„°ë¥¼ ì–»ì–´ì˜¬ ìˆ˜ìˆë„ë¡ ë„ì™€ì¤€ë‹¤.

âœ” ê°¯ì¸ ë¹„ íŠœí† ë¦¬ì–¼ì˜ ê²½ìš° ìœ ëª… í”ŒëŸ¬ê·¸ì¸ì¸ `gatsby-source-filesystem`ë‚˜ `gatsby-source-contentful`ë¥¼ ì˜ˆì‹œë¡œ ë“¤ê³  ìˆë‹¤.

ğŸ¤”ê·¸ëŸ¬ë©´ ê·¸ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ì§€?

- GraphQL ì¿¼ë¦¬ë¬¸ì„ ì´ìš©í•´ì„œ ì›í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì— ë°ì´í„°ë¥¼ í™œìš©í•  ìˆ˜ìˆë„ë¡ í•´ì¤€ë‹¤.

<h3>Use GraphiQL to explore the data layer and write GraphQL queries</h3>

ğŸ¤” ì‚¬ìš©ìê°€ ì–´ë–»ê²Œ ìì‹ ì˜ ì‚¬ì´íŠ¸ì˜ GraphQL ë°ì´í„° ë ˆì´ì–´ë¥¼ ì•Œ ìˆ˜ ìˆì„ê¹Œ?

![ GraphiQL_ex](https://www.gatsbyjs.com/static/c6b53975530da3347f0e0d12fc175208/84a90/graphiql.png)

- ê°¯ì¸ ë¹„ ì—ì„œëŠ” ê°œë°œì ì„œë²„ë¥¼ ì‹¤í–‰í• ë•Œ ìë™ì ìœ¼ë¡œ `GrahpiQL`ì´ë¼ëŠ” ë¸Œë¼ìš°ì € í‹€ì„ ë§Œë“¤ì–´ì£¼ëŠ”ë°,`GrahpiQL`ë¥¼ í†µí•´ì„œ ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ ë³¼ ìˆ˜ìˆë‹¤.

-`gatsby develop.`ì´ë‚˜ ` npm run start`ë“±ìœ¼ë¡œ ì‹œì‘

```
You can now view frog in the browser.
â €
  http://localhost:8000/
â €
View GraphiQL, an in-browser IDE, to explore your site's data and schema
â €
  http://localhost:8000/___graphql
â €
```

-ìœ„ì™€ ê°™ì´ `http://localhost:8000/___graphql`(= `GrahpiQL`ì˜ ì£¼ì†Œ)ë¼ëŠ” ì£¼ì†Œë¥¼ ì–»ê²Œëœë‹¤.

ğŸ¤”`GrahpiQL`?

-`GrahpQL`ì¿¼ë¦¬ë¥¼ ì½”ë“œì— ì¶”ê°€í•˜ê¸°ì „ ì‹œí—˜í•˜ê¸°ì— ìš©ì´í•˜ë‹¤

<h3>Queries in building-block components: Pull the site title into the Layout component</h3>

ì»´í¬ë„ŒíŠ¸ì˜ ì¢…ë¥˜ì— ë”°ë¼ GraphQLì¿¼ë¦¬ë¥¼ ë‹¤ë¥´ê²Œ ì´ìš©í•´ì£¼ëŠ”ë°, íŠœí† ë¦¬ì–¼ ìƒì—ì„œëŠ” building-block ì»´í¬ë„ŒíŠ¸ì˜ ê²½ìš°ë¡œ ì¿¼ë¦¬ë¬¸ì„ ì§„í–‰í•´ ë³¼ ì˜ˆì •ì´ë‹¤.

1. Use GraphiQL to build the query

-ì¼ë‹¨ ì´ì „ì— ì‚¬ìš©í–ˆë˜ `gatsby-config.js`íŒŒì¼ì˜ `siteMetadata`ê°ì²´ë¥¼ í™•ì¸í•´ë³´ì.

```javascript
module.exports = {
  siteMetadata: {
    siteUrl: "https://www.yourdomain.tld",
    title: "Frog with Gatsby",
  },
```

ğŸ‘‰ ì´ ë°ì´í„°ëŠ” íŒŒíŠ¸1ì—ì„œ `new`ë¼ëŠ” ì»¤ë©˜ë“œë¥¼ í™œìš©í•´ì„œ ê°¯ì¸ ë¹„ íŒŒì¼ì„ ì²˜ìŒ ì„¤ì •í•´ì£¼ì—ˆì„ë•Œ ë§Œë“¤ì–´ì§„ ê²ƒìœ¼ë¡œ, GraphQLì˜ ë°ì´í„° ë ˆì´ì–´ì— ìë™ì ìœ¼ë¡œ ì¶”ê°€ë˜ì–´ ì‚¬ìš©ìê°€ ì¶”ê°€ì ìœ¼ë¡œ pluginì„ ì„¤ì¹˜í•´ì¤„ í•„ìš”ê°€ ì—†ë‹¤.

-`localhost:8000/___graphiql`ì— ë“¤ì–´ê°€ `GrahpiQL`ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™•ì¸í•´ë³´ì

![ GraphiQL_ex](/explorer.png)

-ìœ„ì™€ê°™ì€ ì°½ì„ ë³¼ ìˆ˜ìˆëŠ”ë° ì—¬ê¸°ì„œ `site`í•„ë“œë¥¼ ì—´ì–´ì£¼ì.  
-ë‹¤ìŒì— í‘¸ë¥¸ìƒ‰ì˜ `siteMetadata`ë¥¼ ë„£ì–´ì£¼ë©´, `gatsby-config.js`íŒŒì¼ì˜ `siteMetadata`ì™€ ëŒ€ì‘í•˜ê²Œëœë‹¤

ğŸ¤” í™œìš©í•˜ëŠ”ê±´ ê·¸ëŸ­ì €ëŸ­ ì´í•´ê°€ë˜ì—ˆëŠ”ë° ë‹¤ë¥¸ ê²½ìš°ë¥¼ ì•„ì§ ë§Œë‚˜ì§€ ëª»í•´ì„œ ì´ê²ƒì €ê²ƒ í•´ë´ì•¼ì§€ ì´í•´ê°€ í™•ì‹¤í• ê²ƒê°™ìŒ..

```jsx
query MyQuery {
  site {
    siteMetadata {
      title
    }
  }
}
```

ì¿¼ë¦¬ë¥¼ ì§„í–‰í•˜ëŠ” ê²½ìš° ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ìˆë‹¤.

```json
{
  "data": {
    "site": {
      "siteMetadata": {
        "title": "My First Gatsby Site"
      }
    }
  },
  "extensions": {}
}
```

âœ” ì´ë•Œ íŒŒì¼ì„ ìˆ˜ì •í•˜ëŠ” ê²½ìš° ë‹¤ì‹œ ê°¯ì¸ ë¹„ë¥¼ ì‹¤í–‰í•´ ìƒˆë¡œìš´ `GrahpiQL`í˜ì´ì§€ë¥¼ ì—´ì–´ì£¼ì–´ì•¼í•œë‹¤.

2.  Use useStaticQuery to pull the site title into the Layout component

building-block ì»´í¬ë„ŒíŠ¸ì— ë°ì´í„°ë¥¼ ë„£ì–´ì£¼ì–´ì•¼í•˜ëŠ” ê²½ìš° `useStaticQuery`ë¥¼ í™œìš©í•´ ì£¼ì–´ì•¼í•œë‹¤.

ê°€. `useStaticQuery`ì™€ `graphql`ë¥¼ importí•´ì¤€ë‹¤

```jsx

import * as React from 'react'
import { Link, useStaticQuery, graphql } from 'gatsby'
import {
  container,
  heading,
  navLinks,
  navLinkItem,
  navLinkText
} from './layout.module.css'
const Layout = ({ pageTitle, children }) => {
  return (
    // ...
  )
}
export default Layout

```

ë‚˜.GraphiQLì—ì„œ ë°›ì•„ì˜¨ ì¿¼ë¦¬ë¥¼ `useStaticQuery`ë¡œ ë°›ì•„ì¤€ë‹¤. ì´ë•Œ `graphql`ë¥¼ ì´ìš©í•´ GraphQL ì¿¼ë¦¬ë¥¼ ì´ìš©í•´ì¤€ë‹¤ëŠ” ê²ƒì„ ëª…ì‹œí•´ì£¼ê³  ë³€ìˆ˜ì— ì €ì¥í•´ì¤€ë‹¤.

```jsx
const data = useStaticQuery(graphql`
  query {
    site {
      siteMetadata {
        title
      }
    }
  }
`);
```

âœ” ì´ë•Œ GraphiQLì—ì„œ ì–»ì€ ì¿¼ë¦¬ë¬¸ì—ëŠ” `MyQuery`ê°€ ìˆëŠ”ë°, ì‚¬ìš©í• ë•Œ ì´ë¥¼ ì‚­ì œí•´ì£¼ëŠ” ì´ìœ ëŠ” ì´ë¦„ì´ ì¶©ëŒì´ ë‚˜ë©´ ì•ˆë˜ì–´ì„œ !ë¼ëŠ”ë° ë§ëŠ”ì§€ ëª¨ë¥´ê²ŸìŒ ëˆ„ê°€ ì œë°œ ì•Œë ¤ì¤˜ë°” ,,

ë‹¤. ì´ë ‡ê²Œ ê°ì²´ì— ê°’ì„ ì–»ê²Œë˜ë©´, ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸ì— ë„£ì–´ ì‚¬ìš©í•  ìˆ˜ìˆë‹¤.`data.site.siteMetadata.title` ì™€ê°™ì´ ì‘ì„±í•´ ì´ìš©í•´ ì¤„ ìˆ˜ìˆë‹¤.

```jsx
const Layout = ({ pageTitle, children }) => {
  const data = useStaticQuery(graphql`
    query {
      site {
        siteMetadata {
          title
        }
      }
    }
  `)
  return (
    <div className={container}>
      <title>{pageTitle} | {data.site.siteMetadata.title}</title>
      <header>{data.site.siteMetadata.title}</header>
      ...
```

<h3>Queries in page components: Create a blog page with a list of post filenames</h3>

ë¸”ë¡œê·¸í˜ì´ì§€ë¥¼ ë§Œë“¤ì–´ë³´ë©´ì„œ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ë¥¼ í™œìš©í•´ë³´ì!
